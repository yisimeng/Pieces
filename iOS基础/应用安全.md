## 应用安全

### 1. 应用访问

#### 1.1 匿名访问

匿名访问，需要标识设备。

**供应商的标识符（Indentifier for Vendor,IDFV）：**设备上每个应用的持久唯一标识符，用于向应用的供应商标识设备。iOS 7 之后使用BundleID 的除了最后一部分，用于生成IDFV。为确保唯一性，可以通过确保BundleID的前面部分不同，或者使用钥匙串存储ID。同一厂商的最后一个应用卸载后，IDFV会重置。通过`[UIDevice currentDevice].identifierForVendor` 可获取IDFV，

**广告商的标识符（Indentifier for Advertiser,IDFA）：**可重置的，在设备上应用中唯一的标识符。此ID 只可用于广告投放使用，在提交应用是需要标明。

#### 1.2 认证访问

* 应用密码
* 游戏中心。仅适用于游戏，使用GameKit链接游戏中心进行用户验证。
* 第三方认证
* 用户名密码，邮箱，手机号验证。

### 2. 网络安全

#### 2.1 HTTPS

#### 2.2 证书验证

除非像Charles抓包HTTPS那样信任了证书，使用HTTPS证书还是安全的。

### 3. 本地数据安全

在 Capabilities 中选择打开 Data Protection ，系统会使用设备密码对本地数据进行加密存储，意味着在设备解锁前无法访问数据。

### 4. 应用安全清单

**静态代码分析**

* 仅在Debug模式下使用NSLog
* 所有网络请求的使用HTTPS
* 本地文件路径不是硬编码
* 检查最新版本和补丁程序的依赖
* 是否使用私有API
* 代码、资源中是否迁入私钥或隐私
* 运行不到的代码或无用代码
* 权限是否正确
* 是否使用了IDFV、IDFA
* 设置正确的证书、配置文件
* 检查SQL注入

**运行时分析--日志**

* 仅对文件执行日志记录
* 定期删除日志文件
* 日志中是否打印隐私或敏感数据
* 打印栈跟踪时不会记录敏感信息

**运行时分析--网络**

* 只使用HTTPS
* 客户端使用证书校验
* 设置正确的缓存策略
* cookie信息

**运行时分析--认证**

* 登陆UI隐藏密码
* 密码不可复制
* 密码存储在钥匙串中
* 可通过服务器配置更改身份验证的工作流

**运行时分析--本地存储**

* 加密本地存储的敏感信息
* 定期清理本地存储

**运行时分析--数据共享**

* 验证deep-link url
* 验证任何传入的数据
* 不向未知应用共享任何敏感数据
* 使用Share Extension 时设置正确的 group id



